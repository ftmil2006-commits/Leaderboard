<script>
const params = new URLSearchParams(window.location.search);
const group = params.get("group");
const card = document.getElementById("card");

if (!group) {
  card.innerHTML = "â— Please open this page from the leaderboard.";
} else {
  fetch("event_data.json")
    .then(res => {
      if (!res.ok) throw new Error("JSON not found");
      return res.json();
    })
    .then(data => loadBadge(data))
    .catch(() => {
      card.innerHTML = "âŒ Failed to load event data";
    });
}

function loadBadge(data) {
  const t = data.find(x => x.group_name === group);

  if (!t) {
    card.innerHTML = "âŒ Group not found";
    return;
  }

  const membersHTML = `
    <div class="members">
      <p><strong>Members</strong></p>
      <ul>
        ${t.members.split(",").map(m => `<li>â€¢ ${m.trim()}</li>`).join("")}
      </ul>
    </div>
  `;

  card.innerHTML = `
    <h2>${t.group_name}</h2>
    <img src="${getBadgeImage(t.badge)}" class="badge-img">
    <p><strong>${t.badge}</strong></p>
    ${membersHTML}
    <p>ğŸ“¸ Screenshot & share</p>
  `;

  if (t.rank <= 3) launchConfetti();
}

function getBadgeImage(badge) {
  badge = badge.toUpperCase();
  if (badge === "WINNER") return "winner.png";
  if (badge === "SECOND") return "second.png";
  if (badge === "THIRD") return "third.png";
  return "participant.png";
}
</script>
